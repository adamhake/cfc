[build]
  # Build from monorepo root using Turborepo
  package = "apps/web"
  command = "pnpm install --frozen-lockfile && pnpm run build --filter=@chimborazo/web"
  publish = "apps/web/dist/client"
  ignore = "git diff --quiet $CACHED_COMMIT_REF $COMMIT_REF apps/web packages/sanity-config"

[build.environment]
  NODE_VERSION = "22"
  PNPM_FLAGS = "--frozen-lockfile --prefer-offline"

# Cache node_modules and Turborepo cache for faster rebuilds
[[plugins]]
  package = "@netlify/plugin-cache"

  [plugins.inputs]
    paths = [
      "node_modules",
      "apps/web/node_modules",
      "apps/web/.turbo",
      ".turbo"
    ]
